--第一题
use ShiYan;
SELECT SPJ.SNO FROM S,P,SPJ WHERE S.SNO=SPJ.SNO and P.PNO=SPJ.PNO
AND SPJ.JNO='J1' AND PCOLOR='红';
--第二题
SELECT DISTINCT SPJ.JNO FROM S,P,J,SPJ WHERE S.SNO=SPJ.SNO and P.PNO=SPJ.PNO and J.JNO=SPJ.JNO
AND S.CITY!='天津' AND P.PNO NOT IN (SELECT a.PNO FROM P as a WHERE PCOLOR!='红');
--第三题
SELECT DISTINCT JNO FROM SPJ x WHERE NOT EXISTS
	(SELECT * FROM SPJ y WHERE y.SNO='S1' AND NOT EXISTS
			(SELECT * FROM SPJ WHERE X.JNO=JNO AND PNO=y.PNO)
		);
--第四题
SELECT DISTINCT PNAME,WEIGHT FROM SPJ,P,J WHERE SPJ.PNO=P.PNO and SPJ.JNO=J.JNO
AND SPJ.JNO='J2';
--第五题
SELECT DISTINCT SPJ.PNO FROM SPJ,P,S WHERE SPJ.PNO=P.PNO and SPJ.SNO=S.SNO
AND CITY='上海';
--第六题
SELECT JNAME FROM S,J,SPJ WHERE S.SNO=SPJ.SNO and J.JNO=SPJ.JNO AND S.CITY='上海';
--第八题
SELECT PNO FROM P WHERE WEIGHT IN (SELECT min(WEIGHT) FROM P WHERE PCOLOR='红');
--第九题
SELECT DISTINCT SPJ.PNO FROM S,J,SPJ WHERE S.SNO=SPJ.SNO and J.JNO=SPJ.JNO AND S.CITY=J.CITY;
--第十题
SELECT DISTINCT S.CITY,J.CITY,PNAME FROM S,P,J,SPJ WHERE S.SNO=SPJ.SNO and P.PNO=SPJ.PNO and J.JNO=SPJ.JNO;
--第十一题
SELECT DISTINCT S.CITY,J.CITY,PNAME FROM S,P,J,SPJ WHERE S.SNO=SPJ.SNO and P.PNO=SPJ.PNO and J.JNO=SPJ.JNO
AND S.CITY!=J.CITY;
--第十二题
SELECT sum(QTY) FROM J,SPJ WHERE J.JNO=SPJ.JNO AND JNAME LIKE'%厂%' AND SNO='S1';