--第一题
CREATE VIEW S_View AS (SELECT SNO,SNAME FROM S);
--第二题
CREATE VIEW SanJian_View AS (SELECT SPJ.SNO,PNO,QTY FROM J,SPJ WHERE J.JNO=SPJ.JNO AND JNAME='三建');
--第三题
SELECT PNO,QTY FROM SanJian_View;
--第四题
SELECT * FROM SanJian_View WHERE SNO='S1';
--第五题
CREATE VIEW p_View AS (SELECT * FROM P WHERE PCOLOR='红' AND WEIGHT>=10);
--第六题
CREATE VIEW S_Q_View AS (SELECT S.SNO,sum(QTY) as zong FROM S,SPJ WHERE S.SNO=SPJ.SNO GROUP BY S.SNO);
--第七题
CREATE VIEW RVE_View AS (SELECT SNO,max(QTY) da,min(QTY) xiao,avg(QTY) avg FROM SPJ GROUP BY SNO);
SELECT * FROM RVE_View WHERE SNO='S4';
--第八题
UPDATE S_View SET SNAME='为国' WHERE SNO='S5';
SELECT * FROM S;
--第九题
INSERT S_View VALUES ('S6', '华誉', NULL, NULL);
SELECT * FROM S;
--第十题
DELETE * FROM S_Sname_View WHERE SNAME='S1';
--第十一题
CREATE VIEW S_Sname_View AS (SELECT SNAME FROM S_View);
--第十二题
exec sp_rename 'S_View', 'SS_View';
--第十三题
ALTER VIEW SS_View AS SELECT SNO,SNAME,CITY='上海' FROM S;
--第十四题
DROP VIEW SS_View;